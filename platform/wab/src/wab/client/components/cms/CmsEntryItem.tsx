// This is a skeleton starter React component generated by Plasmic.
// This file is owned by you, feel free to edit as you see fit.
import { HTMLElementRefOf } from "@plasmicapp/react-web";
import * as React from "react";
import { Link } from "react-router-dom";
import { ApiCmseRow, ApiCmsTable } from "../../../shared/ApiSchema";
import { useRRouteMatch, UU } from "../../cli-routes";
import {
  DefaultCmsEntryItemProps,
  PlasmicCmsEntryItem,
} from "../../plasmic/plasmic_kit_cms/PlasmicCmsEntryItem";
import { getRowIdentifierNode } from "./CmsEntryDetails";

export interface CmsEntryItemProps extends DefaultCmsEntryItemProps {
  row: ApiCmseRow;
  table: ApiCmsTable;
}

const formatter = new Intl.DateTimeFormat([], {
  dateStyle: "medium",
  timeStyle: "short",
});

function CmsEntryItem_(props: CmsEntryItemProps, ref: HTMLElementRefOf<"div">) {
  const { table, row, ...rest } = props;
  const match = useRRouteMatch(UU.cmsEntry);
  return (
    <PlasmicCmsEntryItem
      {...rest}
      root={{
        as: Link,
        props: {
          ref,
          to: UU.cmsEntry.fill({ ...match!.params, rowId: row.id }),
        },
      }}
      children={getRowIdentifierNode(table, row)}
      isActive={match?.params.rowId === row.id}
      details={formatter.format(new Date(row.updatedAt))}
      hasDraft={!!row.draftData}
    />
  );
}

const CmsEntryItem = React.forwardRef(CmsEntryItem_);
export default CmsEntryItem;
