// This is a skeleton starter React component generated by Plasmic.
// This file is owned by you, feel free to edit as you see fit.
import { HTMLElementRefOf } from "@plasmicapp/react-web";
import { Tooltip } from "antd";
import * as React from "react";
import { useRouteMatch } from "react-router";
import { Link } from "react-router-dom";
import {
  ApiCmsTable,
  CmsDatabaseId,
  CmsTableId,
} from "../../../shared/ApiSchema";
import { UU } from "../../cli-routes";
import {
  DefaultCmsModelItemProps,
  PlasmicCmsModelItem,
} from "../../plasmic/plasmic_kit_cms/PlasmicCmsModelItem";
import { Matcher } from "../view-common";

export interface CmsModelItemProps extends DefaultCmsModelItemProps {
  table: ApiCmsTable;
  matcher?: Matcher;
}

function CmsModelItem_(props: CmsModelItemProps, ref: HTMLElementRefOf<"div">) {
  const { table, matcher, ...rest } = props;
  const match = useRouteMatch<{
    databaseId: CmsDatabaseId;
    tableId?: CmsTableId;
  }>();
  const params = { databaseId: match.params.databaseId, tableId: table.id };
  return (
    <Tooltip title={table.description}>
      <PlasmicCmsModelItem
        {...rest}
        root={{
          as: Link,
          props: {
            to: (match.path.includes("/schemas")
              ? UU.cmsModelSchema
              : UU.cmsModelContent
            ).fill(params),
            ref,
          },
        }}
        isActive={match.params.tableId === table.id}
        children={matcher ? matcher.boldSnippets(table.name) : table.name}
      />
    </Tooltip>
  );
}

const CmsModelItem = React.forwardRef(CmsModelItem_);
export default CmsModelItem;
