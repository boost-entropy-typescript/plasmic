// This is a skeleton starter React component generated by Plasmic.
// This file is owned by you, feel free to edit as you see fit.
import { observer } from "mobx-react-lite";
import * as React from "react";
import { ensure, spawn } from "../../../common";
import { useAppCtx } from "../../contexts/AppContexts";
import { plasmicIFrameMouseDownEvent } from "../../definitions/events";
import {
  DefaultShareButtonProps,
  PlasmicShareButton,
} from "../../plasmic/plasmic_kit_top_bar/PlasmicShareButton";

interface ShareButtonProps extends DefaultShareButtonProps {}

const ShareButton = observer((props: ShareButtonProps) => {
  const appCtx = useAppCtx();
  const topFrameApi = ensure(appCtx.topFrameApi, "missing topFrameApi");
  React.useEffect(() => {
    const handler = () => {
      spawn(topFrameApi.setShowShareModal(false));
    };
    document.addEventListener(plasmicIFrameMouseDownEvent, handler);
    return () => {
      document.removeEventListener(plasmicIFrameMouseDownEvent, handler);
    };
  });
  return (
    <>
      <PlasmicShareButton
        {...props}
        onClick={() => topFrameApi.setShowShareModal(true)}
        tooltip="Share project"
      />
    </>
  );
});

export default ShareButton;
